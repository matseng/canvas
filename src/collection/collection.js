var Rect = require('./shapes.js')

module.exports = (function() {

  var Collection = function() {
    this.shapes = [];
    this.run();
  }

  Collection.prototype.run = function() {
    this.add( new Rect(25,25,100,100) );
    this.add( new Rect(125,125,200,200) );
    this.firebase();
  };

  Collection.prototype.firebase = function() {
    var ref = new Firebase('https://brainspace-biz.firebaseio.com/');
    var notesRef = ref.child('notes2');

    var i = 0;
    notesRef.on("child_added", function(snapshot) {
      var note = snapshot.val();
      console.log(i++, note.style);
      this.add( new Rect(note.data.x, note.data.y, note.style.width, note.style.height));
      // this.add( new Rect(note.style.left, note.style.top, note.style.width, note.style.height));
    }.bind(this));

  };

  Collection.prototype.add = function(shape) {
    this.shapes.push(shape);
  };

  Collection.prototype.get = function() {
    return this.shapes;
  };
  
  return new Collection();

})();
